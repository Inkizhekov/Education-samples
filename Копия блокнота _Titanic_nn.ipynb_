{"cells":[{"cell_type":"markdown","id":"3acb0404","metadata":{"id":"3acb0404"},"source":["# Titanic\n","\n","Задача: определить, выжил ли пассажир на Титанике, зная информацию о пассажире и его билете.\n","\n","Целевая переменная:  \n","\n","Survived - выжил пассажир или нет:\n","- 0 - погиб\n","- 1 - выжил  \n","\n","\n","\n","\n","\n","Используемые признаки:\n","\n","- Age - возраст\n","\n","- Pclass - класс билета. Всего 3 класса.\n","\n","- Sex - пол пассажира.\n","\n","- SibSp — это число братьев, сестер или супругов на борту у человека.\n","\n","- Parch - количество родителей или детей, с которыми путешествовал каждый пассажир.\n","\n","- Fare - стоимость тарифа."]},{"cell_type":"code","execution_count":1,"id":"0ff9b846","metadata":{"id":"0ff9b846","executionInfo":{"status":"ok","timestamp":1665215610452,"user_tz":-420,"elapsed":6432,"user":{"displayName":"Анатолий Инкижеков","userId":"04854426355593330927"}}},"outputs":[],"source":["import pandas as pd\n","\n","from sklearn.model_selection import train_test_split\n","\n","from tensorflow import keras\n","from keras.models import Sequential \n","from keras.layers import Dense\n","\n","import numpy as np"]},{"cell_type":"code","source":["from google.colab import drive\n","drive.mount('/content/drive')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"PTnbunlhkigc","executionInfo":{"status":"ok","timestamp":1665215630955,"user_tz":-420,"elapsed":20508,"user":{"displayName":"Анатолий Инкижеков","userId":"04854426355593330927"}},"outputId":"ff67ead8-5f1c-4800-bc22-90317af3d2ef"},"id":"PTnbunlhkigc","execution_count":2,"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive\n"]}]},{"cell_type":"code","execution_count":5,"id":"4126f03d","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":222},"id":"4126f03d","executionInfo":{"status":"ok","timestamp":1665215654622,"user_tz":-420,"elapsed":6,"user":{"displayName":"Анатолий Инкижеков","userId":"04854426355593330927"}},"outputId":"13b661c2-1d9f-463c-c868-7b8c322bdab5"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["   PassengerId  Survived  Pclass  \\\n","0            1         0       3   \n","1            2         1       1   \n","2            3         1       3   \n","\n","                                                Name     Sex   Age  SibSp  \\\n","0                            Braund, Mr. Owen Harris    male  22.0      1   \n","1  Cumings, Mrs. John Bradley (Florence Briggs Th...  female  38.0      1   \n","2                             Heikkinen, Miss. Laina  female  26.0      0   \n","\n","   Parch            Ticket     Fare Cabin Embarked  \n","0      0         A/5 21171   7.2500   NaN        S  \n","1      0          PC 17599  71.2833   C85        C  \n","2      0  STON/O2. 3101282   7.9250   NaN        S  "],"text/html":["\n","  <div id=\"df-6e0c156b-c60a-4f45-a107-20a9b0de502e\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>PassengerId</th>\n","      <th>Survived</th>\n","      <th>Pclass</th>\n","      <th>Name</th>\n","      <th>Sex</th>\n","      <th>Age</th>\n","      <th>SibSp</th>\n","      <th>Parch</th>\n","      <th>Ticket</th>\n","      <th>Fare</th>\n","      <th>Cabin</th>\n","      <th>Embarked</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>3</td>\n","      <td>Braund, Mr. Owen Harris</td>\n","      <td>male</td>\n","      <td>22.0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>A/5 21171</td>\n","      <td>7.2500</td>\n","      <td>NaN</td>\n","      <td>S</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>2</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>Cumings, Mrs. John Bradley (Florence Briggs Th...</td>\n","      <td>female</td>\n","      <td>38.0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>PC 17599</td>\n","      <td>71.2833</td>\n","      <td>C85</td>\n","      <td>C</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>3</td>\n","      <td>1</td>\n","      <td>3</td>\n","      <td>Heikkinen, Miss. Laina</td>\n","      <td>female</td>\n","      <td>26.0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>STON/O2. 3101282</td>\n","      <td>7.9250</td>\n","      <td>NaN</td>\n","      <td>S</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-6e0c156b-c60a-4f45-a107-20a9b0de502e')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-6e0c156b-c60a-4f45-a107-20a9b0de502e button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-6e0c156b-c60a-4f45-a107-20a9b0de502e');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":5}],"source":["df = pd.read_csv(\"/content/train (2).csv\")\n","df.head(3)"]},{"cell_type":"code","execution_count":6,"id":"ededafe4","metadata":{"id":"ededafe4","colab":{"base_uri":"https://localhost:8080/","height":273},"executionInfo":{"status":"ok","timestamp":1665215659155,"user_tz":-420,"elapsed":8,"user":{"displayName":"Анатолий Инкижеков","userId":"04854426355593330927"}},"outputId":"9652856a-2404-42c6-ff8b-953d8e873335"},"outputs":[{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:3: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame.\n","Try using .loc[row_indexer,col_indexer] = value instead\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  This is separate from the ipykernel package so we can avoid doing imports until\n"]},{"output_type":"execute_result","data":{"text/plain":["   Survived  Pclass  Sex   Age  SibSp  Parch     Fare\n","0         0       3    0  22.0      1      0   7.2500\n","1         1       1    1  38.0      1      0  71.2833\n","2         1       3    1  26.0      0      0   7.9250"],"text/html":["\n","  <div id=\"df-6eb6cd0c-45ce-4dd4-afa7-6623063c7ca7\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Survived</th>\n","      <th>Pclass</th>\n","      <th>Sex</th>\n","      <th>Age</th>\n","      <th>SibSp</th>\n","      <th>Parch</th>\n","      <th>Fare</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>3</td>\n","      <td>0</td>\n","      <td>22.0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>7.2500</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>38.0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>71.2833</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>1</td>\n","      <td>3</td>\n","      <td>1</td>\n","      <td>26.0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>7.9250</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-6eb6cd0c-45ce-4dd4-afa7-6623063c7ca7')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-6eb6cd0c-45ce-4dd4-afa7-6623063c7ca7 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-6eb6cd0c-45ce-4dd4-afa7-6623063c7ca7');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":6}],"source":["df.drop(['PassengerId', 'Name', 'Ticket', 'Cabin', 'Embarked'], axis=1, inplace=True)\n","df = df.dropna()\n","df['Sex'] = df['Sex'].replace({'female': 1, 'male': 0})\n","df.head(3)"]},{"cell_type":"code","execution_count":7,"id":"08a31d69","metadata":{"id":"08a31d69","executionInfo":{"status":"ok","timestamp":1665215662298,"user_tz":-420,"elapsed":2,"user":{"displayName":"Анатолий Инкижеков","userId":"04854426355593330927"}}},"outputs":[],"source":["y = df['Survived']\n","\n","X = df.iloc[:, 1:]\n","X = X.astype(float)"]},{"cell_type":"code","execution_count":8,"id":"3e9493b4","metadata":{"id":"3e9493b4","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1665215668611,"user_tz":-420,"elapsed":304,"user":{"displayName":"Анатолий Инкижеков","userId":"04854426355593330927"}},"outputId":"3b3b4902-9ef1-4530-9622-ce520e710b0f"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["(714, 6)"]},"metadata":{},"execution_count":8}],"source":["X.shape"]},{"cell_type":"code","execution_count":9,"id":"c3ed7822","metadata":{"id":"c3ed7822","executionInfo":{"status":"ok","timestamp":1665215670827,"user_tz":-420,"elapsed":297,"user":{"displayName":"Анатолий Инкижеков","userId":"04854426355593330927"}}},"outputs":[],"source":["X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2)"]},{"cell_type":"code","execution_count":10,"id":"e591aae1","metadata":{"id":"e591aae1","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1665215672683,"user_tz":-420,"elapsed":392,"user":{"displayName":"Анатолий Инкижеков","userId":"04854426355593330927"}},"outputId":"f4fbb0b8-49a9-4701-9ea6-0b357f91a267"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["(571, 6)"]},"metadata":{},"execution_count":10}],"source":["X_train.shape"]},{"cell_type":"code","execution_count":11,"id":"2d98088a","metadata":{"id":"2d98088a","executionInfo":{"status":"ok","timestamp":1665215674579,"user_tz":-420,"elapsed":2,"user":{"displayName":"Анатолий Инкижеков","userId":"04854426355593330927"}}},"outputs":[],"source":["X_train.head(3)"]},{"cell_type":"code","execution_count":null,"id":"f64539e0","metadata":{"id":"f64539e0"},"outputs":[],"source":["y_train.head(3)"]},{"cell_type":"code","execution_count":13,"id":"d5807a9a","metadata":{"id":"d5807a9a","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1665215679334,"user_tz":-420,"elapsed":751,"user":{"displayName":"Анатолий Инкижеков","userId":"04854426355593330927"}},"outputId":"deafea4f-cb63-455d-bf3b-f638810d5099"},"outputs":[{"output_type":"stream","name":"stdout","text":["Model: \"sequential\"\n","_________________________________________________________________\n"," Layer (type)                Output Shape              Param #   \n","=================================================================\n"," dense (Dense)               (None, 9)                 63        \n","                                                                 \n"," dense_1 (Dense)             (None, 9)                 90        \n","                                                                 \n"," dense_2 (Dense)             (None, 5)                 50        \n","                                                                 \n"," dense_3 (Dense)             (None, 1)                 6         \n","                                                                 \n","=================================================================\n","Total params: 209\n","Trainable params: 209\n","Non-trainable params: 0\n","_________________________________________________________________\n"]}],"source":["model = Sequential([\n","    Dense(9, activation = 'relu', input_dim=6),\n","    Dense(9, activation = 'relu'),\n","    Dense(5, activation = 'relu'),\n","    Dense(1, activation = 'sigmoid'),\n","])\n","\n","model.compile(optimizer='adam', \n","              loss='binary_crossentropy', \n","              metrics=['accuracy'])\n","\n","model.summary()"]},{"cell_type":"code","execution_count":14,"id":"45d6d58a","metadata":{"id":"45d6d58a","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1665215683941,"user_tz":-420,"elapsed":1737,"user":{"displayName":"Анатолий Инкижеков","userId":"04854426355593330927"}},"outputId":"2311df5a-3da6-4b20-c378-31cfab313d22"},"outputs":[{"output_type":"stream","name":"stdout","text":["Epoch 1/10\n","18/18 [==============================] - 1s 2ms/step - loss: 0.9442 - accuracy: 0.3993\n","Epoch 2/10\n","18/18 [==============================] - 0s 3ms/step - loss: 0.7568 - accuracy: 0.4746\n","Epoch 3/10\n","18/18 [==============================] - 0s 2ms/step - loss: 0.7127 - accuracy: 0.5482\n","Epoch 4/10\n","18/18 [==============================] - 0s 2ms/step - loss: 0.6940 - accuracy: 0.5744\n","Epoch 5/10\n","18/18 [==============================] - 0s 2ms/step - loss: 0.6842 - accuracy: 0.6042\n","Epoch 6/10\n","18/18 [==============================] - 0s 2ms/step - loss: 0.6802 - accuracy: 0.6287\n","Epoch 7/10\n","18/18 [==============================] - 0s 2ms/step - loss: 0.6751 - accuracy: 0.6252\n","Epoch 8/10\n","18/18 [==============================] - 0s 2ms/step - loss: 0.6724 - accuracy: 0.6550\n","Epoch 9/10\n","18/18 [==============================] - 0s 2ms/step - loss: 0.6701 - accuracy: 0.6497\n","Epoch 10/10\n","18/18 [==============================] - 0s 2ms/step - loss: 0.6665 - accuracy: 0.6480\n"]},{"output_type":"execute_result","data":{"text/plain":["<keras.callbacks.History at 0x7ff690e52f90>"]},"metadata":{},"execution_count":14}],"source":["model.fit(X_train, y_train, batch_size=32, epochs=10)"]},{"cell_type":"code","execution_count":15,"id":"ffb8bb15","metadata":{"id":"ffb8bb15","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1665215697022,"user_tz":-420,"elapsed":433,"user":{"displayName":"Анатолий Инкижеков","userId":"04854426355593330927"}},"outputId":"c6cfcf10-a7c1-4895-a8e1-181935fb2646"},"outputs":[{"output_type":"stream","name":"stdout","text":["5/5 [==============================] - 0s 5ms/step - loss: 0.6505 - accuracy: 0.6853\n"]},{"output_type":"execute_result","data":{"text/plain":["[0.6505087018013, 0.6853147149085999]"]},"metadata":{},"execution_count":15}],"source":["model.evaluate(X_test, y_test)"]},{"cell_type":"code","execution_count":16,"id":"76eff6d8","metadata":{"id":"76eff6d8","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1665215704658,"user_tz":-420,"elapsed":360,"user":{"displayName":"Анатолий Инкижеков","userId":"04854426355593330927"}},"outputId":"ad8e7d88-4b24-4a74-9b31-2b329df913c4"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["(143, 6)"]},"metadata":{},"execution_count":16}],"source":["X_test.shape"]},{"cell_type":"code","execution_count":18,"id":"4e103002","metadata":{"id":"4e103002","executionInfo":{"status":"ok","timestamp":1665215769094,"user_tz":-420,"elapsed":304,"user":{"displayName":"Анатолий Инкижеков","userId":"04854426355593330927"}}},"outputs":[],"source":["y_pred = model.predict(X_test)\n","y_final = (y_pred > 0.5).astype(int).reshape(X_test.shape[0])"]},{"cell_type":"code","execution_count":19,"id":"ce9585e2","metadata":{"id":"ce9585e2","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1665215770968,"user_tz":-420,"elapsed":3,"user":{"displayName":"Анатолий Инкижеков","userId":"04854426355593330927"}},"outputId":"9d4d6b36-0317-4c0b-e65d-5a9db77d7c11"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([0.46843264, 0.46843264, 0.46843264, 0.4912747 , 0.46467593,\n","       0.6339947 , 0.46843264, 0.46843264, 0.46843264, 0.49829116,\n","       0.46843264, 0.46843264, 0.46843264, 0.5024371 , 0.5014142 ,\n","       0.5939798 , 0.46843264, 0.5048995 , 0.46601793, 0.9778939 ,\n","       0.5292864 , 0.46843264, 0.46843264, 0.5566087 , 0.46843264,\n","       0.46843264, 0.82953143, 0.46843264, 0.54436624, 0.46843264,\n","       0.46843264, 0.46843264, 0.46843264, 0.4870308 , 0.46843264,\n","       0.86823845, 0.46843264, 0.60321766, 0.46843264, 0.82364583,\n","       0.46843264, 0.46843264, 0.46843264, 0.46843264, 0.48783058,\n","       0.46843264, 0.46843264, 0.46843264, 0.46843264, 0.46843264,\n","       0.5178519 , 0.46843264, 0.46843264, 0.61006606, 0.46843264,\n","       0.6869106 , 0.46843264, 0.46843264, 0.50212914, 0.51288617,\n","       0.46843264, 0.46843264, 0.46843264, 0.49299118, 0.6675991 ,\n","       0.6449686 , 0.46843264, 0.46843264, 0.46843264, 0.513173  ,\n","       0.5151317 , 0.6627589 , 0.46843264, 0.6834064 , 0.5236175 ,\n","       0.5360504 , 0.46843264, 0.46843264, 0.4544714 , 0.5805799 ,\n","       0.46843264, 0.6685286 , 0.47776425, 0.46843264, 0.69311434,\n","       0.46843264, 0.51166403, 0.52176565, 0.46843264, 0.62805027,\n","       0.7036624 , 0.46843264, 0.6551769 , 0.6314751 , 0.5103307 ,\n","       0.6507397 , 0.45330122, 0.46843264, 0.46843264, 0.46843264,\n","       0.46843264, 0.46843264, 0.7201659 , 0.4794514 , 0.55973995,\n","       0.46843264, 0.46843264, 0.52176565, 0.5139915 , 0.7342322 ,\n","       0.6923785 , 0.46843264, 0.85122865, 0.46843264, 0.46843264,\n","       0.46843264, 0.5594491 , 0.46843264, 0.48309574, 0.46843264,\n","       0.5064507 , 0.46843264, 0.46843264, 0.8068687 , 0.46843264,\n","       0.46843264, 0.46843264, 0.656781  , 0.46843264, 0.46843264,\n","       0.46843264, 0.46843264, 0.46843264, 0.608379  , 0.46843264,\n","       0.4663866 , 0.6623731 , 0.46843264, 0.7255603 , 0.48756903,\n","       0.52954084, 0.46843264, 0.514835  ], dtype=float32)"]},"metadata":{},"execution_count":19}],"source":["y_pred.reshape(X_test.shape[0])"]},{"cell_type":"code","execution_count":20,"id":"0e92b630","metadata":{"id":"0e92b630","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1665215777267,"user_tz":-420,"elapsed":309,"user":{"displayName":"Анатолий Инкижеков","userId":"04854426355593330927"}},"outputId":"e069456f-9720-4e35-c8e5-784a8205313d"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 1, 0, 1, 1, 0,\n","       0, 1, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0,\n","       0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0, 0, 1, 1,\n","       0, 0, 0, 1, 1, 1, 0, 1, 1, 1, 0, 0, 0, 1, 0, 1, 0, 0, 1, 0, 1, 1,\n","       0, 1, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 1, 1, 1,\n","       1, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0,\n","       0, 1, 0, 0, 1, 0, 1, 0, 1, 0, 1])"]},"metadata":{},"execution_count":20}],"source":["y_final"]},{"cell_type":"code","execution_count":21,"id":"04260e9a","metadata":{"id":"04260e9a","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1665215838126,"user_tz":-420,"elapsed":317,"user":{"displayName":"Анатолий Инкижеков","userId":"04854426355593330927"}},"outputId":"c5bb5d6c-31ca-48c7-c7fc-aa4a90319c64"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 1, 1, 1, 0,\n","       0, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 1, 0, 1, 1, 1, 0, 1, 0, 0, 0, 0,\n","       0, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 1, 1, 1,\n","       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 1,\n","       0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 1, 0, 1, 1, 0, 1,\n","       1, 0, 0, 0, 1, 0, 0, 1, 0, 0, 1, 1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0,\n","       0, 1, 0, 0, 1, 0, 1, 0, 0, 1, 1])"]},"metadata":{},"execution_count":21}],"source":["np.array(y_test)"]},{"cell_type":"code","execution_count":22,"id":"1adc4bb5","metadata":{"id":"1adc4bb5","colab":{"base_uri":"https://localhost:8080/","height":81},"executionInfo":{"status":"ok","timestamp":1665215871499,"user_tz":-420,"elapsed":330,"user":{"displayName":"Анатолий Инкижеков","userId":"04854426355593330927"}},"outputId":"ed8ecf8e-6522-45e1-bca6-c823698c614f"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["     Pclass  Sex   Age  SibSp  Parch  Fare\n","443     2.0  1.0  28.0    0.0    0.0  13.0"],"text/html":["\n","  <div id=\"df-a3f55c2e-bd65-42a3-8f4c-1765564cdfe6\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Pclass</th>\n","      <th>Sex</th>\n","      <th>Age</th>\n","      <th>SibSp</th>\n","      <th>Parch</th>\n","      <th>Fare</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>443</th>\n","      <td>2.0</td>\n","      <td>1.0</td>\n","      <td>28.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>13.0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-a3f55c2e-bd65-42a3-8f4c-1765564cdfe6')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-a3f55c2e-bd65-42a3-8f4c-1765564cdfe6 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-a3f55c2e-bd65-42a3-8f4c-1765564cdfe6');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":22}],"source":["X_test.head(1)"]},{"cell_type":"code","execution_count":23,"id":"41b241bb","metadata":{"id":"41b241bb","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1665215875167,"user_tz":-420,"elapsed":314,"user":{"displayName":"Анатолий Инкижеков","userId":"04854426355593330927"}},"outputId":"09e64080-dcd0-41e4-b941-bbe38b5b79c3"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["Index(['Pclass', 'Sex', 'Age', 'SibSp', 'Parch', 'Fare'], dtype='object')"]},"metadata":{},"execution_count":23}],"source":["X_test.columns"]},{"cell_type":"code","execution_count":24,"id":"aaa7d288","metadata":{"id":"aaa7d288","executionInfo":{"status":"ok","timestamp":1665215877026,"user_tz":-420,"elapsed":301,"user":{"displayName":"Анатолий Инкижеков","userId":"04854426355593330927"}}},"outputs":[],"source":["men = np.array(X_test)[0]"]},{"cell_type":"code","execution_count":26,"id":"93819600","metadata":{"id":"93819600","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1665216041134,"user_tz":-420,"elapsed":447,"user":{"displayName":"Анатолий Инкижеков","userId":"04854426355593330927"}},"outputId":"59795de5-5bd4-4953-e89e-8052169c5eb4"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["(6,)"]},"metadata":{},"execution_count":26}],"source":["men.shape"]},{"cell_type":"code","execution_count":27,"id":"85b4437d","metadata":{"id":"85b4437d","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1665216043417,"user_tz":-420,"elapsed":331,"user":{"displayName":"Анатолий Инкижеков","userId":"04854426355593330927"}},"outputId":"bdd3d385-62c1-4bf3-d69d-2b167ee4a1eb"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([[ 2.,  1., 28.,  0.,  0., 13.]])"]},"metadata":{},"execution_count":27}],"source":["men.reshape((1, 6))"]},{"cell_type":"code","execution_count":28,"id":"7b9ac307","metadata":{"id":"7b9ac307","executionInfo":{"status":"ok","timestamp":1665216046044,"user_tz":-420,"elapsed":305,"user":{"displayName":"Анатолий Инкижеков","userId":"04854426355593330927"}}},"outputs":[],"source":["men_pred = model.predict(men.reshape((1, 6)))[0][0]"]},{"cell_type":"code","execution_count":29,"id":"6ca0d1f7","metadata":{"id":"6ca0d1f7","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1665216048034,"user_tz":-420,"elapsed":331,"user":{"displayName":"Анатолий Инкижеков","userId":"04854426355593330927"}},"outputId":"2b7bf163-5795-4bd9-87bf-817573e4ed8b"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["0"]},"metadata":{},"execution_count":29}],"source":["int(men_pred > 0.5)"]},{"cell_type":"code","execution_count":30,"id":"555d6332","metadata":{"id":"555d6332","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1665216049846,"user_tz":-420,"elapsed":355,"user":{"displayName":"Анатолий Инкижеков","userId":"04854426355593330927"}},"outputId":"45306968-da70-4617-cc3b-f79ff496f1df"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([[0.47650528]], dtype=float32)"]},"metadata":{},"execution_count":30}],"source":["model.predict([[2., 1., 99., 0., 0., 8.]])"]},{"cell_type":"code","execution_count":31,"id":"f48fd255","metadata":{"scrolled":true,"id":"f48fd255","executionInfo":{"status":"ok","timestamp":1665216053170,"user_tz":-420,"elapsed":1124,"user":{"displayName":"Анатолий Инкижеков","userId":"04854426355593330927"}}},"outputs":[],"source":["model.save(\"titanic_mlp\")"]},{"cell_type":"markdown","id":"9172edb5","metadata":{"id":"9172edb5"},"source":["---"]},{"cell_type":"code","execution_count":32,"id":"d312ef7a","metadata":{"id":"d312ef7a","executionInfo":{"status":"ok","timestamp":1665216055142,"user_tz":-420,"elapsed":845,"user":{"displayName":"Анатолий Инкижеков","userId":"04854426355593330927"}}},"outputs":[],"source":["model_loaded = keras.models.load_model(\"titanic_mlp\")"]},{"cell_type":"code","execution_count":33,"id":"3998d35b","metadata":{"id":"3998d35b","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1665216056886,"user_tz":-420,"elapsed":596,"user":{"displayName":"Анатолий Инкижеков","userId":"04854426355593330927"}},"outputId":"7a98f791-4381-410f-f6f0-cd729c391059"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([[0.47650528]], dtype=float32)"]},"metadata":{},"execution_count":33}],"source":["model_loaded.predict([[2., 1., 99., 0., 0., 8.]])"]}],"metadata":{"kernelspec":{"display_name":"Python 3 (ipykernel)","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.8.12"},"colab":{"provenance":[{"file_id":"1VvViSJqaFmVStTGQ43LiC2KVRi3N_vSo","timestamp":1665215583578}]}},"nbformat":4,"nbformat_minor":5}